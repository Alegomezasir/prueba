import{j as e,bK as J,l as u,aH as Y,av as Z,bL as $,r as E,bj as R,bM as I,bN as ee,bO as se,bP as ie,bQ as te,t as j,bR as ae,bS as ne,bT as re,bU as oe,bV as le,bW as de}from"./main-1.0.4.js";import{u as M,S as ce,a as me,I as U,b as pe,c as ue,d as _,D as ge,e as xe,f as he,g as je,h as be,T as fe,M as ye,P as Se}from"./useMetadataColumns-1.0.4-ef7a068d.js";import{u as k,B as g,b as G,M as w,a as ke,U as m,K as ve,a5 as Ne,a6 as Te,a7 as Ae,o as Pe,a8 as Ee,a9 as Me,aa as we,ab as De,ac as Fe,ad as Le,D as Ce}from"./main-1.0.4-3f927327.js";import{h as Oe}from"./index.esm-1.0.4-1e92c0c7.js";import{S as x,a as v,C as Re}from"./TabPanel-1.0.4-14af6bd6.js";import{u as A}from"./useTableUpdater-1.0.4-77e86903.js";import{b as T,F as y,a as S,T as P,A as Ue}from"./TextField-1.0.4-6b1bbbfd.js";import{a as H}from"./ScopeEnum-1.0.4-3d855cbf.js";import{P as V}from"./PremiumFeature-1.0.4-532b0a19.js";import{b as _e,c as Be,a as Ge}from"./index.esm-1.0.4-15c38c3e.js";import{A as D,a as F,b as L}from"./AccordionSummary-1.0.4-dffa253b.js";import{F as h}from"./FormControlLabel-1.0.4-64c2f78b.js";import{R as Ve}from"./RadioGroup-1.0.4-078a1a14.js";import{R as B}from"./Radio-1.0.4-bd38ebb7.js";import{A as b,a as f}from"./TableContainer-1.0.4-e085ec9c.js";import{C as ze}from"./Checkbox-1.0.4-04061c16.js";import{I as N}from"./iconBase-1.0.4-684ba590.js";import"./useStoreTable-1.0.4-d7e93f06.js";import"./CardContent-1.0.4-55ef4296.js";import"./AdminTheme-1.0.4-e85d4fc0.js";import"./ActionsDml-1.0.4-1a4856d6.js";import"./MenuItem-1.0.4-50d14a51.js";import"./index-1.0.4-6dbd728b.js";import"./Stepper-1.0.4-274e952c.js";import"./Close-1.0.4-ca2bff70.js";import"./DialogContent-1.0.4-604ea0cd.js";import"./Tabs-1.0.4-276a4db7.js";import"./useSlot-1.0.4-77de692c.js";import"./index.esm-1.0.4-862c3851.js";import"./colorManipulator-1.0.4-6ca57637.js";import"./AlertTitle-1.0.4-103cc369.js";import"./InputAdornment-1.0.4-7c5d0d8f.js";import"./DateTimePicker-1.0.4-20c15877.js";import"./useMobilePicker-1.0.4-98bcd65f.js";import"./date-time-utils-1.0.4-cff519f0.js";import"./dateViewRenderers-1.0.4-e82b214f.js";import"./TimePicker-1.0.4-46bc9359.js";import"./DatePicker-1.0.4-29fd3332.js";import"./index-1.0.4-57a42597.js";import"./vi-1.0.4-f5e66e81.js";import"./dayjs.min-1.0.4-2ecacb3f.js";const He=({appId:t,columnIndex:o,tableColumn:s})=>{const a=k(),c=A(t);return e.jsxs(g,{sx:{margin:"0 1rem 2rem 1rem"},children:[e.jsx(T,{children:"Width"}),e.jsxs(g,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gridGap:"30px",alignItems:"center"},children:[e.jsx(H,{min:60,max:420,step:1,value:s.width,marks:[{value:60,label:"60"},{value:120,label:"120"},{value:180,label:"180"},{value:240,label:"240"},{value:300,label:"320"},{value:360,label:"360"},{value:420,label:"420"}],valueLabelDisplay:"auto",onChange:(i,l)=>{a(J({appId:t,index:o,width:l})),c(!0),i.stopPropagation()}}),e.jsx("span",{children:"px"})]})]})},We=({appId:t,columnIndex:o,tableColumn:s})=>{var l,n;u.debug(t,o,s),k();const a=Y(Z.getState(),t);M(t,a);const c=G(d=>$(d,t));E.useState(!1),A(t);const i=!0;return e.jsxs(D,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(_e,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column actions"})]}),e.jsxs(L,{sx:{display:"grid",paddingTop:"1rem"},children:[e.jsxs(g,{sx:{margin:"0 10px",display:"grid",gridTemplateColumns:"auto"},children:[s.computedField?e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0}),label:"Enable inline search",labelPlacement:"end"}):e.jsx(h,{control:e.jsx(x,{checked:s.inlineSearch&&!i,disabled:i,onChange:(d,C)=>{d.stopPropagation()}}),label:"Enable column filtering",labelPlacement:"end"}),s.inlineSearch&&!i&&e.jsxs(g,{children:[e.jsxs(Ve,{sx:{flexDirection:"column",alignContent:"flex-start",marginLeft:"20px",marginTop:"10px",marginBottom:"10px"},children:[e.jsxs(T,{className:"align-label-radio",children:[e.jsx(B,{checked:s.inlineSearchEnum===R.SEARCHBOX,disabled:!0,onChange:d=>{d.stopPropagation()}}),"Searchbox"]}),e.jsxs(T,{className:"align-label-radio",children:[e.jsx(B,{checked:s.inlineSearchEnum===R.DROPDOWN,disabled:!0,onChange:d=>{d.stopPropagation()}}),"Drop-down list"]}),e.jsxs(T,{className:"align-label-radio",children:[e.jsx(B,{checked:s.inlineSearchEnum===R.MULTISELECT,disabled:!0,onChange:d=>{d.stopPropagation()}}),"Multi-select drop-down list"]})]}),e.jsx(e.Fragment,{children:s.lookup!==void 0&&((l=s.lookup)==null?void 0:l.loadOnStartup)!==!0&&e.jsx(y,{sx:{marginBottom:"20px"},children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ke,{size:"24px"}),e.jsx("span",{children:"Drop-down list are only supported for lookups loaded into memory on startup."})]})})})]}),((n=a==null?void 0:a.privs)==null?void 0:n.update)&&a.primary_key.length>0&&e.jsx(e.Fragment,{children:s.computedField?e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0}),label:"Enable inline editing",labelPlacement:"end"}):e.jsx(h,{control:e.jsx(x,{checked:c&&s.visible&&s.inlineEditing,disabled:!0,onChange:(d,C)=>{d.stopPropagation()}}),label:"Enable inline editing",labelPlacement:"end"})})]}),!1,e.jsx(V,{})]})]})},Qe=({appId:t,columnIndex:o,tableColumn:s})=>{const a=k(),c=A(t),i=M(t),l=(n,d)=>{u.debug(n,d)};return e.jsxs(D,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Be,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(L,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[!s.computedField&&i[s.columnName]!==void 0&&m(i[s.columnName].data_type)==="string"&&i[s.columnName].data_type!=="enum"&&i[s.columnName].data_type!=="set"&&e.jsxs(y,{children:[e.jsx(h,{control:e.jsx(x,{checked:s.allowMarkup,onChange:(n,d)=>{a(I({appId:t,index:o,allowMarkup:d})),c(!0),n.stopPropagation()}}),label:"Allow inline HTML",labelPlacement:"end"}),e.jsx(S,{children:"Allows users to use markup in column content. Enabling this feature can generate cross-site scripting (XSS) messages."})]}),e.jsxs(g,{sx:{display:"grid",gridTemplateColumns:"auto"},children:[e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{l(o,!s.visibleTablet),n.stopPropagation()}}),label:"Show column on tablet",labelPlacement:"end"}),e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Show column on mobile",labelPlacement:"end"})]}),(s.computedField||i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="float"||m(i[s.columnName].data_type)==="number"||m(i[s.columnName].data_type)==="date"||m(i[s.columnName].data_type)==="time"||m(i[s.columnName].data_type)==="datetime"))&&e.jsx(g,{children:e.jsxs(y,{children:[e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Localize numeric value",labelPlacement:"end"}),e.jsx(S,{children:s.computedField||i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="float"||m(i[s.columnName].data_type)==="number")?"Localizes decimal and thousands seperators (does not affect inline fields)":"Localizes date and time fields (does not affect inline fields)"})]})}),i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="float"||s.computedField)&&e.jsxs(y,{children:[e.jsx(T,{children:"Decimals"}),e.jsx(H,{min:0,max:6,value:s.decimals,marks:[{value:0,label:"0"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"âˆž"}],valueLabelDisplay:"off",disabled:!0,onChange:(n,d)=>{u.debug(d),n.stopPropagation()}}),e.jsx(S,{children:"Number of decimals displayed"})]}),i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="date"||m(i[s.columnName].data_type)==="datetime")&&e.jsx(g,{children:e.jsx(y,{children:e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Add trailing zeros to days and month",labelPlacement:"end"})})}),i[s.columnName]!==void 0&&(m(i[s.columnName].data_type)==="time"||m(i[s.columnName].data_type)==="datetime")&&e.jsx(g,{children:e.jsx(y,{children:e.jsx(h,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Add trailing zeros to hours, minutes and seconds",labelPlacement:"end"})})}),e.jsxs(y,{children:[e.jsxs(g,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(P,{type:"text",variant:"outlined",label:"Prefix",value:s.prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}}),e.jsx(P,{type:"text",variant:"outlined",label:"Suffix",value:s.suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}})]}),e.jsx(S,{children:"Adds a prefix and/or suffix to the column content (also added to inline text and number fields)"})]}),e.jsxs(y,{children:[e.jsx(P,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:s.classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}}),e.jsx(S,{children:"CSS classes (seperated by spaces) for custom styling"})]}),e.jsx(V,{single:!1,margin:"0"})]})]})},qe=[{key:b.SUM,label:f.SUM},{key:b.MIN,label:f.MIN},{key:b.MAX,label:f.MAX},{key:b.AVG,label:f.AVG},{key:b.COUNT,label:f.COUNT},{key:b.UNIQUE,label:f.UNIQUE},{key:b.STD,label:f.STD},{key:b.VARIANCE,label:f.VARIANCE},{key:b.MEDIAN,label:f.MEDIAN}],z=[...qe],Xe=({appId:t,columnIndex:o,tableColumn:s})=>{u.debug(t,o,s),k(),A(t);const a=M(t),c=E.useMemo(()=>{var i;return(s==null?void 0:s.aggregation)===void 0?[]:(i=s==null?void 0:s.aggregation)==null?void 0:i.map(l=>z.filter(n=>n.key===l)[0])},[s==null?void 0:s.aggregation]);return!ve(t)||s.computedField===void 0&&m(a[s.columnName].data_type)!=="number"?null:e.jsxs(D,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ge,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Aggregations"})]}),e.jsxs(L,{sx:{marginTop:"10px"},children:[e.jsxs(y,{fullWidth:!0,children:[e.jsx(Ue,{multiple:!0,options:z,disabled:!0,disableCloseOnSelect:!0,getOptionLabel:i=>i.label,value:c,onChange:(i,l)=>{i.stopPropagation()},renderOption:(i,l,{selected:n})=>e.jsxs("li",{...i,children:[e.jsx(ze,{icon:e.jsx(Ne,{}),checkedIcon:e.jsx(Te,{}),style:{marginRight:8},checked:n}),l.label]}),renderInput:i=>e.jsx(P,{...i,label:"Select from list"})}),e.jsx(S,{children:"Allows multiple selections. Displayed in order of entry."})]}),e.jsx(V,{})]})]})},Ke=({appId:t,columnIndex:o,tableColumn:s})=>{u.debug(t,o,s);const a=k(),i=M(t)[s.columnName],l=(n,d)=>{a(ee({appId:t,columnName:s.columnName})),a(se({appId:t,columnName:s.columnName})),a(ie({appId:t,index:n,lookup:d}))};return e.jsxs(e.Fragment,{children:[e.jsx(He,{appId:t,columnIndex:o,tableColumn:s}),e.jsx(Qe,{appId:t,columnIndex:o,tableColumn:s}),e.jsx(We,{appId:t,columnIndex:o,tableColumn:s}),e.jsx(ce,{appId:t,columnIndex:o,tableColumn:s,columnMetaData:i,setLookup:l}),e.jsx(Xe,{appId:t,columnIndex:o,tableColumn:s}),e.jsx(me,{columnMetaData:i})]})},Je=({appId:t,columnIndex:o})=>{u.debug(t,o);const s=k(),a=G(r=>te(r,t,o));u.debug("tableColumn",a);const c=A(t),[i,l]=E.useState(!1),[n,d]=E.useState(void 0),C=r=>{r!==void 0&&(s(ae({appId:t,index:r})),c(!0))},W=(r,p)=>{u.debug(r,p),s(ne({appId:t,index:r,visible:p})),c(!0)},Q=(r,p)=>{u.debug(r,p),s(re({appId:t,index:r,queryable:p})),c(!0)},q=(r,p)=>{u.debug(r,p),s(oe({appId:t,index:r,orderable:p})),c(!0)},O=(r,p)=>{s(le({appId:t,index:r,alignment:p})),c(!0)},X=(r,p,K)=>(u.debug(r,p,K),e.jsxs(e.Fragment,{children:[e.jsx(g,{sx:{"& svg":{pointerEvents:"none",opacity:"0.5"}},children:e.jsx(pe,{id:r,enabled:!1},r)}),e.jsxs(g,{sx:{display:"inline-grid",gridTemplateColumns:a.computedField!==void 0?"auto auto":"auto",justifyContent:"start",alignItems:"center",gap:"10px","& svg":{opacity:"0.5"}},children:[a.computedField!==void 0&&e.jsx(Oe,{}),e.jsx(T,{children:p})]})]}));return e.jsxs(e.Fragment,{children:[e.jsxs(D,{disableGutters:!0,slotProps:{transition:{unmountOnExit:!0}},children:[e.jsxs(F,{className:"pp-column-settings",expandIcon:e.jsx(w,{}),sx:{justifyContent:"space-between"},children:[e.jsx(g,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center","& svg":{display:"flex"}},children:X(a.columnName,a.columnLabel,o)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 40px 40px 40px"},children:[e.jsx(v,{title:"Visibility",position:"bottom",children:e.jsx(N,{onClick:r=>{W(o,!a.visible),r.stopPropagation()},children:e.jsx(U,{checked:a.visible,children:e.jsx(Ae,{})})})}),a.computedField?e.jsx(v,{title:"Edit",position:"bottom",children:e.jsx(N,{onClick:r=>{r.stopPropagation()},children:e.jsx(Ee,{})})}):e.jsx(v,{title:"Searchable",position:"bottom",children:e.jsx(N,{onClick:r=>{Q(o,!a.queryable),r.stopPropagation()},children:e.jsx(U,{checked:a.queryable,alignRight:!1,children:e.jsx(Pe,{})})})}),a.computedField?e.jsx(v,{title:"Delete",position:"bottom",children:e.jsx(N,{onClick:r=>{d(o),l(!0),r.stopPropagation()},children:e.jsx(we,{})})}):e.jsx(v,{title:"Sortable",position:"bottom",children:e.jsx(N,{onClick:r=>{q(o,!a.orderable),r.stopPropagation()},children:e.jsx(U,{checked:a.orderable,children:e.jsx(Me,{})})})}),e.jsx(v,{title:"Alignment",position:"bottom",children:e.jsxs(N,{onClick:r=>{a.alignment===j.LEFT?O(o,j.CENTER):a.alignment===j.CENTER?O(o,j.RIGHT):a.alignment===j.RIGHT&&O(o,j.LEFT),c(!0),r.stopPropagation()},children:[a.alignment===j.LEFT&&e.jsx(De,{}),a.alignment===j.CENTER&&e.jsx(Fe,{}),a.alignment===j.RIGHT&&e.jsx(Le,{})]})})]})]}),e.jsx(L,{children:e.jsx(Ke,{appId:t,columnIndex:o,tableColumn:a})})]},o),e.jsx(Re,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:i,setOpen:l,onConfirm:()=>C(n)})]})},Us=({appId:t,metaData:o})=>{u.debug(t,o),k();const s=ue(_(Se),_(ye),_(fe));A(t);const a=i=>{const{active:l,over:n}=i;u.debug(l,n),l==null||l.id,n==null||n.id},c=G(i=>de(i,t));return c===void 0||c.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx(ge,{autoScroll:!0,sensors:s,collisionDetection:xe,onDragEnd:a,children:e.jsx(he,{items:c,children:c.map((i,l)=>e.jsx(je,{id:i,children:e.jsx(Je,{appId:t,columnIndex:l})},i))})}),e.jsx(be,{appId:t,target:Ce.TABLE})]})};export{Us as default};
